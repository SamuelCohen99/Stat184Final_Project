---
title: "Final Project - Fencing Champions"
author: "Samuel Cohen, Alex Schweizer"
date: "4/26/20"
output: html_notebook
---

# Question: Throughout the history of fencing, which countries and which athletes within those countries excelled in the sport of fencing throughout time and earned medals in international tournaments, such as the FIE World Fencing Championships, and the Olympics?

## Setup:

```{r}
library(xml2)
library(rvest)
library(ggplot2)
library(tidyr)
library(dplyr)
library(DataComputing)
library(tidyverse)
#library(maps)
```

```{r}
fie <- "https://en.wikipedia.org/wiki/World_Fencing_Championships#World_champions"
fielist <- fie %>%
  read_html() %>%
  html_nodes(css = "table") %>%
  html_table(fill = TRUE)
```
```{r}
olympics <- "https://en.wikipedia.org/wiki/List_of_Olympic_medalists_in_fencing_(men)"
olympicslist <- olympics %>%
  read_html() %>%
  html_nodes(css = "table") %>%
  html_table(fill = TRUE)
```

### Links to data sources: 

FIE Championships:    https://en.wikipedia.org/wiki/World_Fencing_Championships#World_champions

Olympics:    https://en.wikipedia.org/wiki/List_of_Olympic_medalists_in_fencing_(men)

## About the first data source: 

The first dataset contains charts of data from the FIE (Federation Internationale d'Escrime) World Fencing Championships, such as the medal count of each country, the gold medalists of each event for each year and weapon, and the top 10 international fencers in each weapon with the highest medal count. This data would be held within FIE's website, but apparently there is a Wikipedia page for it, saving me the time. The Wikipedia page was sourced by former fencer, Richard Cohen (not related), and externally linked to the FIE webpage. This data has been recorded since the first ever tournament in 1921, and is kept recorded in the archives for the history books. 

Here are some of the tables in the dataset:

```{r}
medalranks <- fielist[[6]] %>%
  filter(row_number() < 43)
medalranks
```

*Each case of this table is a ranking of the number of gold, silver, and bronze medals a country has earned.

```{r}
Sabers <- fielist[[9]]
Sabers
```

*Each case in this table is the champion individuals or Country's teams in a given year.

## About the Second data source:

The Second dataset contains charts of data of the champions of the men's fencing event of the Summer Olympics. all of this data is collected by the International Olympics Committee, or IOC for short; however, there is no provider on whom published the data onto Wikipedia. The results of each Olympic Games are collected as records of history. 

Here are some of the tables from the data source:

```{r}
Olympic_Saber <- olympicslist[[5]]
Olympic_Saber
```

Each Case in this table is the Gold, Silver, and Bronze medallists of an Olympic Games.

```{r}
Olympic_S_Team <- olympicslist[[6]]
Olympic_S_Team
```

Each case in this table are the Gold, Silver, and Bronze teams of an Olympic Games.


##Data Wrangling 

###Tables to Start With
```{r}
View(Sabers)
View(OlympicMedals)
View(Olympic_S_Team)
View(medalranks)
View(Olympic_Saber)
```


#### (A) General Data Wrangling: 

- Examples: filter, mutate, summarise, arrange, group_by, etc.

```{r}
Gold_Olympics <- OlympicMedals %>% select(Nation, Gold) 
Gold_FIE <- medalranks %>% select(Nation, Gold) 
Total_Olympics <- OlympicMedals %>% select(Nation, Total) 
Total_FIE <- medalranks %>% select(Nation, Total) %>% arrange(desc(Total))

rename(Sabers, Men)
f <- Sabers %>% filter(Year > 1947) %>% rename(c("Men's individual" = "Men Sabers"))

View(f)
```


- (B) Join Operation: 


```{r}
JoinMedal <- medalranks %>% select(Rank, Nation)
Joined <- JoinMedal %>% left_join(OlympicMedals %>% select(Rank, Nation), by= "Rank") 

View(Joined)
```


- (C) Spread or Gather: 


```{r}

Olympics_Locations <- Joined_RegEx %>% select(Years, Locations) %>% spread(key= Years, value= Locations)

Gold_Nations <- Gold_FIE %>% select(Nation, Gold) %>% filter(Gold > 9) %>% spread(key= Nation, value= Gold) 

View(Gold_Nations)

View(Olympics_Locations)
```


- (D) Reg Ex: 


```{r}
#
Details <- Olympic_Saber %>% mutate(New= gsub("details", "", Games))

#  
Years <- Details %>% extractMatches("([0-9][0-9][0-9][0-9])", New) %>% mutate(Years= match1) %>% select(Games, Years)

#
Locations <- Details %>% mutate(Locations = gsub("[0-9][0-9][0-9][0-9]", "", New))

Joined_RegEx <- Years %>% left_join(Locations, by="Games") %>% select(Years, Locations, Gold, Silver, Bronze)

View(Joined_RegEx)
```


- (E) Reduction/Transformation: 

```{r}
Total_Games <- Olympic_Saber %>% summarise(total= sum(n())-1)
Total_Olympics %>% mutate(Average_Total_Medals_per_Year = Total/28)
```

(F) .Rmd Line number(s) for use of user-defined functions:

```{r}

  
```



##Data Visualization


```{r}
ggplot(data=medalranks,aes(x=reorder(Nation,Gold),y=Total ))+geom_bar(stat='identity',position='stack', width=.9) + theme(axis.text.x=element_text(angle=60,hjust=1)) 
```

This plot is a bar graph representing the total medal count and ordered by the number of Gold medals each country has. (Not Summarised). I believe looking at the medal count of each country would be the good starting point to determine the most-dominant countries in the sport.

```{r}
OlympicMedals <- olympicslist[[12]] %>%
  filter(row_number() < 34)

ggplot(data=OlympicMedals,aes(x=reorder(Nation,Total),y=Total,order=reorder(Gold,Gold),fill=Gold))+geom_bar(stat='identity',position='stack', width=.9) + theme(axis.text.x=element_text(angle=60,hjust=1)) 
```

Here is another chart regarding the total count of Olympic medals with a fill order of gold medals. Similar start, and also plan to join the two tables together to get a grand total of medals. 

To conclude, This feels like a good starting point to what I can investigate on. Within the next few weeks, I plan to construct various plots, such as a scatterplot of individual and team medals within various years to eventually find some kind of trend or pattern of which country has dominated the sport of fencing over the sport's history.

(A) .Rmd Line number(s) for use of mulitple different geoms:  

(B) .Rmd Line number(s) for use of multiple aesthetics:  

(C) .Rmd Line number(s) for use of layered graphics:  

(D) .Rmd Line number(s) for use of leaflet maps: 
```{r}
WorldMap(medalranks, key = Nation, fill = Total)
```
(E) .Rmd Line number(s) for use of decision tree or dendogram results:    






